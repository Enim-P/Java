<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>练习</title>
</head>
<body>
  <script>
    // 学生类型
    function Student(no,name,age,sex){
      this.no = no 
      this.name = name
      this.age = age
      this.sex = sex
    }

    // 学校对象
    let school = {
      // 学生数组
      students:[
        new Student('1001','小明',20,'男'),
        new Student('1002','小王',21,'女'),
        new Student('1003','小强',22,'男'),
        new Student('1004','小芳',23,'女')
      ],
      // 查看学生
      show:function(){
        //将所有学生的信息展示出来
        let str = ""
        this.students.forEach(s=>{
          str += `${s.no} ${s.name} ${s.age} ${s.sex}\n`
        })
        alert(str)
      },
      // 添加学生
      add:function(){
        //学号是不能重复的
        let no = prompt('请输入学号：')
        if(this.students.some(s=>s.no==no)){
          alert('学号不能重复！')
          return
        }
        let name = prompt('请输入姓名：')
        let age = parseInt(prompt('请输入年龄：'))
        let sex = prompt('请输入性别：')
        //创建学生对象
        let stu = new Student(no,name,age,sex)
        this.students.push(stu)
        alert('添加成功！')
      },
      // 修改学生
      up:function(){
        //根据学号修改其他信息
        let no = prompt('请输入需要修改的学生学号：')
        let stu = this.students.find(s=>s.no==no)
        // 判断是否找到了该学生
        if(stu){
          stu.name = prompt('请输入修改后的姓名：')
          stu.age = parseInt(prompt('请输入修改后的年龄：'))
          stu.sex = prompt('请输入修改后的性别：')
          alert('修改成功！')
        }else{
          alert('学号不存在！')
        }
      },
      // 删除学生
      del:function(){
        //根据学号删除学生
        let no = prompt('请输入需要删除的学生学号：')
        let index = this.students.findIndex(s=>s.no==no)
        if(index!=-1){
          this.students.splice(index,1)
          alert('删除成功！')
        }else{
          alert('学号不存在！')
        }
      },
      // 菜单方法
      menu:function(){
        let no = parseInt(prompt(`学生管理系统
        1.查看学生 2.添加学生 3.修改学生 4.删除学生 0.退出系统`))
        if(no==1){
          this.show()  //调用查看方法
        }else if(no==2){
          this.add()  //调用添加方法
        }else if(no==3){
          this.up()   //调用修改方法
        }else if(no==4){
          this.del()  //调用删除方法
        }else{
          alert('成功退出！')
          return
        }
        // 采用递归调用
        //this.menu()
        //这里通过call每次重新修正this的指向
        arguments.callee.call(this)
      }
    }
    // 调用学校的菜单方法
    school.menu()
  </script>
</body>
</html>